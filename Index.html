<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Happy Birthday Sister! ğŸ‰</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-20px); }
        }
        .cake-float {
            animation: float 4s ease-in-out infinite;
        }
        .balloon {
            animation: bounce 3s ease-in-out infinite;
        }
        @keyframes moveBackground {
            0% { background-position: 0% 0%; }
            25% { background-position: 5% 5%; }
            50% { background-position: 0% 10%; }
            75% { background-position: -5% 5%; }
            100% { background-position: 0% 0%; }
        }
        body {
            background-image: url('background.jpg');
            background-size: 120%;
            background-position: center;
            background-attachment: fixed;
            animation: moveBackground 15s ease-in-out infinite;
        }
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.15);
            backdrop-filter: blur(2px);
            pointer-events: none;
            z-index: 0;
        }
        #app {
            position: relative;
            z-index: 1;
        }
        
        /* iPhone Optimization */
        @media (max-width: 640px) {
            body {
                background-size: 150%;
            }
            .container {
                max-width: 100% !important;
                padding: 0.5rem !important;
            }
            h1 {
                font-size: 2rem !important;
            }
            p {
                font-size: 0.95rem !important;
            }
            .balloon {
                width: 2rem !important;
                height: 3rem !important;
            }
            .text-3xl {
                font-size: 1.5rem !important;
            }
        }
    </style>
</head>
<body class="min-h-screen">
    <div id="app" class="relative min-h-screen overflow-hidden">
        <!-- Floating Balloons -->
        <div class="absolute inset-0 pointer-events-none overflow-hidden">
            <div class="absolute w-12 h-16 bg-red-400 rounded-full opacity-70 shadow-lg balloon" style="left: 10%; top: 15%; animation-delay: 0s;"></div>
            <div class="absolute w-12 h-16 bg-yellow-400 rounded-full opacity-70 shadow-lg balloon" style="left: 20%; top: 25%; animation-delay: 0.5s;"></div>
            <div class="absolute w-12 h-16 bg-blue-400 rounded-full opacity-70 shadow-lg balloon" style="left: 75%; top: 20%; animation-delay: 1s;"></div>
            <div class="absolute w-12 h-16 bg-green-400 rounded-full opacity-70 shadow-lg balloon" style="left: 85%; top: 35%; animation-delay: 1.5s;"></div>
            <div class="absolute w-12 h-16 bg-pink-400 rounded-full opacity-70 shadow-lg balloon" style="left: 15%; top: 65%; animation-delay: 2s;"></div>
            <div class="absolute w-12 h-16 bg-purple-400 rounded-full opacity-70 shadow-lg balloon" style="left: 80%; top: 75%; animation-delay: 2.5s;"></div>
        </div>

        <!-- Floating Cakes -->
        <div class="absolute inset-0 pointer-events-none">
            <div class="absolute text-3xl cake-float" style="left: 20%; top: 10%; animation-delay: 0s;">ğŸ‚</div>
            <div class="absolute text-3xl cake-float" style="left: 40%; top: 20%; animation-delay: 0.8s;">ğŸ‚</div>
            <div class="absolute text-3xl cake-float" style="left: 60%; top: 15%; animation-delay: 1.6s;">ğŸ‚</div>
            <div class="absolute text-3xl cake-float" style="left: 80%; top: 25%; animation-delay: 2.4s;">ğŸ‚</div>
            <div class="absolute text-3xl cake-float" style="left: 30%; top: 80%; animation-delay: 3.2s;">ğŸ‚</div>
        </div>

        <!-- Mode Toggle Button -->
        <button id="modeToggle" onclick="toggleMode()" class="fixed top-4 right-4 z-50 bg-white/90 backdrop-blur-sm px-3 py-2 rounded-full shadow-lg hover:bg-white transition flex items-center gap-2 text-gray-800 font-semibold text-sm">
            <i class="fas fa-eye"></i> <span class="hidden sm:inline">Display</span>
        </button>

        <!-- Main Content -->
        <div class="relative z-10 container mx-auto px-3 sm:px-4 py-6 sm:py-8">
            <!-- Birthday Message -->
            <div class="text-center mb-6 sm:mb-8 bg-white/70 backdrop-blur-sm rounded-2xl sm:rounded-3xl p-5 sm:p-8 shadow-2xl max-w-2xl mx-auto border-4 border-pink-400">
                <div class="flex justify-center mb-3 sm:mb-4">
                    <span class="text-4xl sm:text-5xl animate-pulse">âœ¨</span>
                </div>
                <h1 class="text-3xl sm:text-5xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-pink-600 to-purple-600 mb-3 sm:mb-4">
                    Happy Birthday, Jumoke! ğŸ‰
                </h1>
                <p class="text-base sm:text-xl text-gray-700 leading-relaxed mb-3 sm:mb-4">
                   Happy birthday my love!! ğŸ˜â¤â¤. I want you to know how much you mean to me. 
                   You're not just my sister, you're my best friend, my confidant,
                    my number 1 fan and my partner in crimeğŸ’ƒğŸ¾ğŸ’ƒğŸ¾. 
                </p>
                <p class="text-sm sm:text-lg text-gray-600 mb-3 sm:mb-4">
                  You're such a sweet and amazing soul and you deserve everything good in life.
                   I pray the Lord continues to keep you strong, peaceful, and surrounded by love.
                    May He satisfy you with long life and fill your heart with laughter every single day.
                     You are loved and cherishedğŸ˜. May this year bring you endless happiness, success, 
                    and all the beautiful moments you deserve Jummy kpom kpom.
                </p>
                <p class="text-lg sm:text-2xl font-semibold text-pink-600">
                    I love you very muchğŸ˜â¤â¤
                </p>
            </div>

            <!-- Upload Section - Only in Edit Mode -->
            <div id="uploadSection" class="hidden bg-white/70 backdrop-blur-sm rounded-2xl p-4 sm:p-6 shadow-xl max-w-2xl mx-auto mb-6">
                <h2 class="text-xl sm:text-2xl font-bold text-gray-800 mb-4 text-center">
                    Add Birthday Messages ğŸ
                </h2>
                <div class="flex gap-3 justify-center flex-wrap">
                    <label class="cursor-pointer bg-gradient-to-r from-blue-500 to-blue-600 text-white px-4 sm:px-6 py-2 sm:py-3 rounded-lg shadow-lg hover:from-blue-600 hover:to-blue-700 transition flex items-center gap-2 text-sm sm:text-base">
                        <i class="fas fa-upload"></i> <span class="hidden sm:inline">Upload</span> Audio
                        <input type="file" accept="audio/*" class="hidden" onchange="handleFileUpload(event, 'audio')">
                    </label>
                    <label class="cursor-pointer bg-gradient-to-r from-purple-500 to-purple-600 text-white px-4 sm:px-6 py-2 sm:py-3 rounded-lg shadow-lg hover:from-purple-600 hover:to-purple-700 transition flex items-center gap-2 text-sm sm:text-base">
                        <i class="fas fa-upload"></i> <span class="hidden sm:inline">Upload</span> Video
                        <input type="file" accept="video/*" class="hidden" onchange="handleFileUpload(event, 'video')">
                    </label>
                </div>
                <button onclick="downloadConfig()" class="mt-4 w-full bg-gradient-to-r from-green-500 to-green-600 text-white px-4 sm:px-6 py-2 sm:py-3 rounded-lg shadow-lg hover:from-green-600 hover:to-green-700 transition flex items-center justify-center gap-2 text-sm sm:text-base">
                    <i class="fas fa-download"></i> Download Config
                </button>
                <p class="text-xs sm:text-sm text-gray-600 text-center mt-3">
                    Upload files & download config
                </p>
            </div>

            <!-- Media Items -->
            <div id="mediaContainer" class="bg-white/70 backdrop-blur-sm rounded-2xl p-4 sm:p-6 shadow-xl max-w-2xl mx-auto hidden">
                <h3 class="text-lg sm:text-xl font-bold text-gray-800 mb-4">Birthday Messages</h3>
                <div id="mediaList" class="space-y-3"></div>
            </div>

            <!-- Empty State -->
            <div id="emptyState" class="bg-white/70 backdrop-blur-sm rounded-2xl p-6 sm:p-8 shadow-xl max-w-2xl mx-auto text-center">
                <p class="text-gray-600 text-base sm:text-lg">
                    No birthday messages yet. Switch to Edit Mode to add some! ğŸ
                </p>
            </div>
        </div>
    </div>

    <script>
        let mediaItems = [];
        let playingId = null;
        let mode = 'display';
        let uploadedFiles = {};

        // Initialize
        window.addEventListener('DOMContentLoaded', () => {
            loadMediaItems();
        });

        function toggleMode() {
            mode = mode === 'edit' ? 'display' : 'edit';
            updateUI();
        }

        function updateUI() {
            const modeToggle = document.getElementById('modeToggle');
            const uploadSection = document.getElementById('uploadSection');
            const mediaContainer = document.getElementById('mediaContainer');

            if (mode === 'edit') {
                modeToggle.innerHTML = '<i class="fas fa-eye-slash"></i> <span class="hidden sm:inline">Edit</span>';
                uploadSection.classList.remove('hidden');
            } else {
                modeToggle.innerHTML = '<i class="fas fa-eye"></i> <span class="hidden sm:inline">Display</span>';
                uploadSection.classList.add('hidden');
            }

            renderMediaList();
        }

        function handleFileUpload(event, type) {
            const file = event.target.files[0];
            if (!file) return;

            if (file.size > 50 * 1024 * 1024) {
                alert('File size too large! Maximum 50MB allowed.');
                return;
            }

            let name = prompt(`Enter a label for this ${type}:`, file.name.replace(/\.[^/.]+$/, ''));
            if (name === null) return;
            if (!name.trim()) name = `${type} ${mediaItems.length + 1}`;

            const fileId = Date.now();
            const newItem = {
                id: fileId,
                type,
                name: name.trim(),
                fileName: file.name,
                fileSize: (file.size / 1024 / 1024).toFixed(2) + ' MB'
            };

            uploadedFiles[fileId] = file;
            mediaItems.push(newItem);
            saveToLocalStorage();
            renderMediaList();

            console.log(`âœ… ${type} uploaded: ${file.name}`);
        }

        async function loadMediaItems() {
            try {
                const resp = await fetch('media-config.json', {cache: "no-store"});
                if (resp.ok) {
                    const cfg = await resp.json();
                    if (cfg && Array.isArray(cfg.media) && cfg.media.length > 0) {
                        mediaItems = cfg.media.map((m, i) => ({
                            id: Date.now() + i,
                            name: m.name,
                            type: m.type,
                            fileName: m.fileName,
                            fileSize: m.fileSize || '',
                            url: `media/${m.fileName}`
                        }));
                        updateUI();
                        return;
                    }
                }
            } catch (e) {
                console.log('Config load failed, using localStorage');
            }

            const saved = localStorage.getItem('birthdayMedia');
            if (saved) {
                mediaItems = JSON.parse(saved);
            }
            updateUI();
        }

        function renderMediaList() {
            const mediaContainer = document.getElementById('mediaContainer');
            const mediaList = document.getElementById('mediaList');
            const emptyState = document.getElementById('emptyState');

            if (!mediaList) return;
            if (mediaItems.length === 0) {
                mediaContainer.classList.add('hidden');
                if (mode === 'display') emptyState.classList.remove('hidden');
                else emptyState.classList.add('hidden');
                return;
            }

            mediaContainer.classList.remove('hidden');
            emptyState.classList.add('hidden');

            mediaList.innerHTML = mediaItems.map(item => {
                const file = uploadedFiles[item.id];
                const src = file ? URL.createObjectURL(file) : (item.url || `media/${item.fileName}`);
                const isReady = src ? 'âœ…' : 'â³';

                return `
                    <div class="bg-gradient-to-r from-pink-50 to-purple-50 p-3 sm:p-4 rounded-lg shadow">
                        <div class="flex items-center justify-between mb-2 flex-wrap gap-2">
                            <h4 class="font-semibold text-gray-800 text-sm sm:text-base">
                                ${item.type === 'audio' ? 'ğŸµ' : 'ğŸ¥'} ${item.name} ${isReady}
                            </h4>
                            <div class="flex gap-2">
                                ${src ? `
                                    <button onclick="playFile('${src}')" class="p-2 bg-green-500 text-white rounded-full hover:bg-green-600 transition text-xs sm:text-sm">
                                        <i class="fas fa-play"></i>
                                    </button>
                                ` : ''}
                                ${mode === 'edit' ? `
                                    <button onclick="renameItem(${item.id})" class="p-2 bg-blue-500 text-white rounded-full hover:bg-blue-600 transition text-xs sm:text-sm" title="Rename">
                                        <i class="fas fa-pencil-alt"></i>
                                    </button>
                                    <button onclick="deleteItem(${item.id})" class="p-2 bg-red-500 text-white rounded-full hover:bg-red-600 transition text-xs sm:text-sm" title="Delete">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                ` : ''}
                            </div>
                        </div>
                        <p class="text-xs text-gray-500">ğŸ“„ ${item.fileName || ''} ${item.fileSize ? `(${item.fileSize})` : ''}</p>
                        ${src ? `
                            ${item.type === 'audio' 
                                ? `<audio src="${src}" class="w-full mt-2" controls></audio>`
                                : `<video src="${src}" class="w-full rounded-lg mt-2" controls></video>`
                            }
                        ` : ''}
                    </div>
                `;
            }).join('');
        }

        function renameItem(id) {
            const item = mediaItems.find(i => i.id === id);
            if (!item) return;

            const newName = prompt('Enter new name:', item.name);
            if (newName === null || !newName.trim()) return;

            item.name = newName.trim();
            saveToLocalStorage();
            renderMediaList();
        }

        function deleteItem(id) {
            if (!confirm('Delete this item?')) return;

            mediaItems = mediaItems.filter(item => item.id !== id);
            delete uploadedFiles[id];
            saveToLocalStorage();
            renderMediaList();
        }

        function playFile(srcOrId) {
            const all = Array.from(document.querySelectorAll('audio,video'));
            for (const el of all) {
                const data = el.src || '';
                if (data && data.includes(srcOrId)) {
                    el.play().catch(()=>{});
                    return;
                }
            }
        }

        function downloadConfig() {
            if (mediaItems.length === 0) {
                alert('No media files to download!');
                return;
            }

            const config = {
                version: '1.0',
                createdAt: new Date().toISOString(),
                media: mediaItems.map(item => ({
                    name: item.name,
                    type: item.type,
                    fileName: item.fileName,
                    fileSize: item.fileSize
                }))
            };

            const dataStr = JSON.stringify(config, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = 'media-config.json';
            link.click();
            URL.revokeObjectURL(url);
        }

        function saveToLocalStorage() {
            const dataToSave = mediaItems.map(item => ({
                id: item.id,
                type: item.type,
                name: item.name,
                fileName: item.fileName,
                fileSize: item.fileSize
            }));
            localStorage.setItem('birthdayMedia', JSON.stringify(dataToSave));
        }

        window.addEventListener('DOMContentLoaded', () => {
            loadMediaItems();
        });
    </script>
</body>
</html>